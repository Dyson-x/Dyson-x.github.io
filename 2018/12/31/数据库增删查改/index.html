<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="数据库笔记###表的增删改差 1. 插入是否更新 如果主键或者唯一键对应只存在可以选择性的进行同步更新操作 12insert ... on duplicate key update	column = value [,column = value] ...  举例 1insert into students （id,sn,name） values （100,10010，&amp;apos;lalala&amp;ap">
<meta property="og:type" content="article">
<meta property="og:title" content="Dyson&#39;s blog">
<meta property="og:url" content="http://yoursite.com/2018/12/31/数据库增删查改/index.html">
<meta property="og:site_name" content="Dyson&#39;s blog">
<meta property="og:description" content="数据库笔记###表的增删改差 1. 插入是否更新 如果主键或者唯一键对应只存在可以选择性的进行同步更新操作 12insert ... on duplicate key update	column = value [,column = value] ...  举例 1insert into students （id,sn,name） values （100,10010，&amp;apos;lalala&amp;ap">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-12-31T13:21:07.464Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dyson&#39;s blog">
<meta name="twitter:description" content="数据库笔记###表的增删改差 1. 插入是否更新 如果主键或者唯一键对应只存在可以选择性的进行同步更新操作 12insert ... on duplicate key update	column = value [,column = value] ...  举例 1insert into students （id,sn,name） values （100,10010，&amp;apos;lalala&amp;ap">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/31/数据库增删查改/"/>





  <title> | Dyson's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  

  <div class="container  page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dyson's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">永远的爱着你！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/31/数据库增删查改/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dyson">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/background.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dyson's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline"></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-31T21:23:46+08:00">
                2018-12-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="数据库笔记"><a href="#数据库笔记" class="headerlink" title="数据库笔记"></a>数据库笔记</h2><p>###表的增删改差</p>
<h4 id="1-插入是否更新"><a href="#1-插入是否更新" class="headerlink" title="1. 插入是否更新"></a>1. 插入是否更新</h4><ul>
<li><p>如果主键或者唯一键对应只存在可以选择性的进行同步更新操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert ... on duplicate key update</span><br><span class="line">	column = value [,column = value] ...</span><br></pre></td></tr></table></figure>
<ul>
<li><p>举例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into students （id,sn,name） values （100,10010，&apos;lalala&apos;） on delicate key update sn=10010,name=&apos;lalala&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>select row_count();</code><strong>查看函数获取受到影响的数据行数</strong></p>
</li>
</ul>
</li>
</ul>
<p>####2.替换（replace） </p>
<ul>
<li>主键或者唯一键没有冲突，则直接插入</li>
<li>主键或者唯一键有冲突，则删除后再插入</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace into students (sn,name) values (20001,&apos;曹阿瞒&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="Retrieve"><a href="#Retrieve" class="headerlink" title="Retrieve"></a>Retrieve</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE exam_result (   </span><br><span class="line">id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,   </span><br><span class="line">name VARCHAR(20) NOT NULL COMMENT &apos;同学姓名&apos;,   </span><br><span class="line">yuwen float DEFAULT 0.0 COMMENT &apos;语文成绩&apos;,    </span><br><span class="line">shuxue float DEFAULT 0.0 COMMENT &apos;数学成绩&apos;,    </span><br><span class="line">yingyu float DEFAULT 0.0 COMMENT &apos;英语成绩&apos; );</span><br><span class="line"></span><br><span class="line">INSERT INTO exam_result (name, yuwen, shuxue, yingyu) VALUES    </span><br><span class="line">(&apos;唐三藏&apos;, 67, 98, 56),   </span><br><span class="line">(&apos;孙悟空&apos;, 87, 78, 77),   </span><br><span class="line">(&apos;猪悟能&apos;, 88, 98, 90), </span><br><span class="line">(&apos;曹孟德&apos;, 82, 84, 67),  </span><br><span class="line">(&apos;刘玄德&apos;,55,85,45),</span><br><span class="line">(&apos;孙权&apos;, 70, 73, 78),</span><br><span class="line">(&apos;宋公明&apos;,75,65,30);</span><br></pre></td></tr></table></figure>
<p>####1.select列</p>
<ol>
<li><p>全列查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表明;</span><br></pre></td></tr></table></figure>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 查询的列越多，意味着传输的数据越大</li>
<li style="list-style: none"><input type="checkbox"> 可能会影响引索的使用</li>
</ul>
</li>
<li><p>指定列查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 指定列的顺序不需要按定义表的顺序进行查询</span><br><span class="line">select id,name,yuwen from exam_result;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询字段为表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 表达式不包含字段</span><br><span class="line">select id,name,666 from exam_result;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 表达式包含一个字段</span><br><span class="line">select id,name,yuwen+10 from exam_result;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 表达式包含多个字段，并且将查询结果指定别名</span><br><span class="line"> select id,name,yuwen+shuxue+yingyu as total from exam_result;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询结果去重（distinct）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select distinct shuxue from exam_result;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-where条件"><a href="#2-where条件" class="headerlink" title="2.where条件"></a>2.where条件</h4><ol>
<li><p>英语不及格的同学以及英语成绩（&lt;60）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select neme,yingyu from exam_result where yingyu&lt;60;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语文成绩在[80,90]分的同学以及语文成绩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name,yuwen from exam_result where yuwen&gt;80 and yuwen&lt;90;</span><br><span class="line">--- 使用between...and... 条件</span><br><span class="line">select name,yuwen from exam_result where yuwen between 80 and 90;</span><br></pre></td></tr></table></figure>
</li>
<li><p>数学成绩是58或者59或者98或者99分的同学及数学成绩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name,shuxue from exam_result where shuxue=58 or shuxue=59 or shuxue=98 or shuxue=99;</span><br><span class="line">--- 使用 in 条件</span><br><span class="line">select name,shuxue from exam_result where shuxue in (58,59,98,99);</span><br></pre></td></tr></table></figure>
</li>
<li><p>姓孙的同学及孙某同学</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- %匹配多个任意字符  _匹配一个任意字符</span><br><span class="line">select name from exam_result where name like &apos;孙%&apos; or &apos;孙_&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语文成绩好于英语成绩的同学</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,yuwen,shuxue from exam_result where yuwen&gt;shuxue;</span><br></pre></td></tr></table></figure>
</li>
<li><p>总分在200分一下的同学</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 注意：由于执行顺序的原因(后面详细说明)，别名不能在where条件中使用</span><br><span class="line">select name ,yuwen+shuxue+yingyu as total from exam_result where yuwen+shuxue+yingyu&lt;200;</span><br></pre></td></tr></table></figure>
</li>
<li><p>语文成绩&gt;80且不姓孙的同学</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,yuwen from exam_result where yuwen&gt;80 and name not like &apos;孙%&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>孙某同学，否则要求总成绩&gt;200并且语文成绩&lt;数学成绩并且英语成绩&gt;80</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,yuwen+shuxue+yingyu as total from exam_result where name like &apos;孙_&apos; or (yuwen+shuxue+yingyu&gt;200 and yuwen&lt;shuxue and yingyu&gt;80);</span><br></pre></td></tr></table></figure>
</li>
<li><p>NULL查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">--- NULL和NULL比较，=和&lt;=&gt;的区别</span><br><span class="line">select null=null,null=1,null=0;</span><br><span class="line">+-----------+--------+--------+</span><br><span class="line">| null=null | null=1 | null=0 |</span><br><span class="line">+-----------+--------+--------+</span><br><span class="line">|      NULL |   NULL |   NULL |</span><br><span class="line">+-----------+--------+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">select null&lt;=&gt;null,null&lt;=&gt;1,null&lt;=&gt;0;</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">| null&lt;=&gt;null | null&lt;=&gt;1 | null&lt;=&gt;0 |</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">|           1 |        0 |        0 |</span><br><span class="line">+-------------+----------+----------+</span><br><span class="line">1 row in set (0.03 sec)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>####3.排序结果</p>
<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- ASC 为升序（从小到大）</span><br><span class="line">-- DESC 为降序（从大到小）</span><br><span class="line">-- 默认 ASC</span><br><span class="line">SELECT ... FROM table_name [WHERE ...]     ORDER BY column [ASC|DESC], [...];</span><br></pre></td></tr></table></figure>
<p><strong>注意：没有order by子句的查询，返回的顺序是未定义的，永远不要依赖这个顺序</strong></p>
<ol>
<li><p>同学及数学成绩，按数学成绩升序显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,shuxue from exam_result order by shuxue;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>NULL</strong>视为比任何值都要小，升序出现在最上面，降序出现在最下面</p>
</li>
<li><p>查询同学各门成绩，一次按数学降序，英语升序，语文升序的方式显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- 多字段排序，排序优先级随书写顺序</span><br><span class="line">select name,yuwen,shuxue,yingyu from exam_result order by shuxue desc,yingyu,yuwen;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询同学及总分，由高到低</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,yuwen+shuxue+yingyu as total from exam_result order by total desc;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询姓孙的同学或者姓曹的同学数学成绩，结果按照数学成绩由高到低显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name,shuxue from exam_result where name like &apos;孙%&apos; or name like &apos;曹%&apos; order by shuxue desc;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4-筛选分页结果"><a href="#4-筛选分页结果" class="headerlink" title="4.筛选分页结果"></a>4.筛选分页结果</h4><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---其实下标为0</span><br><span class="line"></span><br><span class="line">---从0开始，筛选n条结果</span><br><span class="line">SELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT n</span><br><span class="line"></span><br><span class="line">---从s开始，筛选n条结果</span><br><span class="line">SELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT s, n;</span><br><span class="line"></span><br><span class="line">---从s开始，筛选n条结果，比第二种用法更明确，建议使用</span><br><span class="line">SELECT ... FROM table_name [WHERE ...] [ORDER BY ...] LIMIT n OFFSET s;</span><br></pre></td></tr></table></figure>
<ul>
<li>建议：队未知表进行查询时，最好加一条<strong>limit 1</strong>，避免因为表中数据过大，查询全表数据导致数据库卡死</li>
</ul>
<ol>
<li><p>按id进行分页，每页3条记录，分别显示第1,2,3页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">--- 第一页</span><br><span class="line">select id,name,yuwen,shuxue,yingyu from exam_result order by id limit 3 offset 0;</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">| id | name      | yuwen | shuxue | yingyu |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">|  1 | 唐三藏    |    67 |     98 |     56 |</span><br><span class="line">|  2 | 孙悟空    |    87 |     78 |     77 |</span><br><span class="line">|  3 | 猪悟能    |    88 |     98 |     90 |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line"></span><br><span class="line">--- 第二页</span><br><span class="line">select id,name,yuwen,shuxue,yingyu from exam_result order by id limit 3 offset 3;</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">| id | name      | yuwen | shuxue | yingyu |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">|  4 | 曹孟德    |    82 |     84 |     67 |</span><br><span class="line">|  5 | 刘玄德    |    55 |     85 |     45 |</span><br><span class="line">|  6 | 孙权      |    70 |     73 |     78 |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line"></span><br><span class="line">--- 第三页，如果结果不足3个，不会对数据有影响</span><br><span class="line">select id,name,yuwen,shuxue,yingyu from exam_result order by id limit 3 offset 6;</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">| id | name      | yuwen | shuxue | yingyu |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br><span class="line">|  7 | 宋公明    |    75 |     65 |     30 |</span><br><span class="line">+----+-----------+-------+--------+--------+</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>####5.Updata</p>
<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table_name SET column = expr [, column = expr ...]    [WHERE ...] [ORDER BY ...] [LIMIT ...]</span><br></pre></td></tr></table></figure>
<p><strong>对查询到的接轨进行列值更新</strong></p>
<ol>
<li><p>将孙悟空同学的数学成绩变更为80分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update exam_result set shuxue=80 where name=&apos;孙悟空&apos;;</span><br><span class="line">Query OK, 1 row affected (0.14 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>将曹孟德同学成绩变更为60分，语文成绩变更为70分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update exam_result set shuxue=60,yuwen=70 where name=&apos;曹孟德&apos;;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>将总成绩倒数前三的3位同学的数学成绩加上30分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update exam_result set shuxue=shuxue+30 order by shuxue+yuwen+yingyu limit 3;</span><br></pre></td></tr></table></figure>
</li>
<li><p>将所有同学的语文成绩更新为原来的2倍</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update exam_result set yuwen=yuwen*2;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="6-Delete"><a href="#6-Delete" class="headerlink" title="6.Delete"></a>6.Delete</h4><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM  table_name [WHERE ...] [ORDER BY ...] [LIMIT ...]</span><br></pre></td></tr></table></figure>
<ol>
<li><p>删除孙悟空同学的考试成绩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from exam_result where name=&apos;孙悟空&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除整张表数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from exam_result;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>截断表（truncate）</strong></p>
<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE [TABLE] table_name</span><br></pre></td></tr></table></figure>
<ul>
<li>注意：该操作慎用<ol>
<li>只能对整张表操作，不能像delete一样针对部分数据操作</li>
<li>直接全部删除，不关心表中所存储的数据</li>
<li>会重置auto_increment项</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="7-插入查询结果（将一张表查询结果插入到另外一张表中）"><a href="#7-插入查询结果（将一张表查询结果插入到另外一张表中）" class="headerlink" title="7. 插入查询结果（将一张表查询结果插入到另外一张表中）"></a>7. 插入查询结果（将一张表查询结果插入到另外一张表中）</h4><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table_name [(column [, column ...])] SELECT ...</span><br></pre></td></tr></table></figure>
<ul>
<li><p>案例：删除表中重复记录，重复的数据值能有一份</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">-- 创建原表数据</span><br><span class="line">mysql&gt; CREATE TABLE duplicate_table (id int, name varchar(20));</span><br><span class="line">Query OK, 0 rows affected (0.45 sec)</span><br><span class="line"></span><br><span class="line">-- 插入测试数据</span><br><span class="line">mysql&gt; INSERT INTO duplicate_table VALUES</span><br><span class="line">	(100, &apos;aaa&apos;),    </span><br><span class="line">	(100, &apos;aaa&apos;),   </span><br><span class="line">	(200, &apos;bbb&apos;),    </span><br><span class="line">	(200, &apos;bbb&apos;),    </span><br><span class="line">	(200, &apos;bbb&apos;),    </span><br><span class="line">	(300, &apos;ccc&apos;);</span><br><span class="line">Query OK, 6 rows affected (0.09 sec)</span><br><span class="line">Records: 6  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">-- 建立一张空表，空表的结构和原表的结构相同</span><br><span class="line">mysql&gt; CREATE TABLE no_duplicate_table LIKE duplicate_table;</span><br><span class="line">Query OK, 0 rows affected (0.42 sec)</span><br><span class="line"></span><br><span class="line">-- 将原表去重后的数据插入到新表中</span><br><span class="line">mysql&gt; INSERT INTO no_duplicate_table SELECT DISTINCT * FROM duplicate_table;</span><br><span class="line">Query OK, 3 rows affected (0.11 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">-- 通过重命名表，实现原子操作（就不用担心在去重的过程中会有新的数据插入）</span><br><span class="line">mysql&gt; RENAME TABLE duplicate_table TO old_duplicate_table,     no_duplicate_table TO duplicate_table;</span><br><span class="line">Query OK, 0 rows affected (0.47 sec)</span><br><span class="line"></span><br><span class="line">-- 查看结果</span><br><span class="line">mysql&gt; SELECT * FROM duplicate_table</span><br><span class="line">    -&gt; ;</span><br><span class="line">+------+------+</span><br><span class="line">| id   | name |</span><br><span class="line">+------+------+</span><br><span class="line">|  100 | aaa  |</span><br><span class="line">|  200 | bbb  |</span><br><span class="line">|  300 | ccc  |</span><br><span class="line">+------+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="8-聚合函数"><a href="#8-聚合函数" class="headerlink" title="8. 聚合函数"></a>8. 聚合函数</h4><ol>
<li><p>统计班级共有多少学生</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- 这里以 * 做统计，不受mull影响</span><br><span class="line">select count(*) from students;</span><br><span class="line">+----------+</span><br><span class="line">| count(*) |</span><br><span class="line">+----------+</span><br><span class="line">|        4 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.05 sec)</span><br><span class="line"></span><br><span class="line">-- 使表达式做统计</span><br><span class="line">select count(10) from students;</span><br><span class="line">+-----------+</span><br><span class="line">| count(10) |</span><br><span class="line">+-----------+</span><br><span class="line">|         4 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计班级收集qq号有多少</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- null不会计入结果</span><br><span class="line">select count(qq) from students;</span><br><span class="line">+-----------+</span><br><span class="line">| count(qq) |</span><br><span class="line">+-----------+</span><br><span class="line">|         1 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计本次考试的数学成绩分数个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(shuxue) from exam_result;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计数学成绩总分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select sum(shuxue) from exam_result;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计平均总分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select avg(shuxue+yingyu+yuwen) from exam_result;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回英语最高分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select max(yingyu) from exam_result;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回&gt;70分以上的数学最低分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select min(shuxue) from exam_result where shuxue&gt;70;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="9-group-by子句的使用"><a href="#9-group-by子句的使用" class="headerlink" title="9.group by子句的使用"></a>9.group by子句的使用</h4><p>语法：在select中使用group by子句可以对指定列进行分组查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select column1, column2, .. from table group by column;</span><br></pre></td></tr></table></figure>
<p>案例：</p>
<ul>
<li><p>创建一个雇员信息表</p>
<ul>
<li>emp 员工表</li>
<li>dept 部门表</li>
<li>salgrade 工资等级表</li>
</ul>
</li>
<li><p>显示每个部门的平均工资和最高工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select deptno,avg(sal),max(sal) from emp group by deptno;</span><br><span class="line">+--------+-------------+----------+</span><br><span class="line">| deptno | avg(sal)    | max(sal) |</span><br><span class="line">+--------+-------------+----------+</span><br><span class="line">|     10 | 2916.666667 |  5000.00 |</span><br><span class="line">|     20 | 2175.000000 |  3000.00 |</span><br><span class="line">|     30 | 1566.666667 |  2850.00 |</span><br><span class="line">+--------+-------------+----------+</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示每个部门的每种岗位的平均工资和最高工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">select avg(sal),min(sal),job,deptno from emp group by deptno,job;</span><br><span class="line">+-------------+----------+-----------+--------+</span><br><span class="line">| avg(sal)    | min(sal) | job       | deptno |</span><br><span class="line">+-------------+----------+-----------+--------+</span><br><span class="line">| 1300.000000 |  1300.00 | CLERK     |     10 |</span><br><span class="line">| 2450.000000 |  2450.00 | MANAGER   |     10 |</span><br><span class="line">| 5000.000000 |  5000.00 | PRESIDENT |     10 |</span><br><span class="line">| 3000.000000 |  3000.00 | ANALYST   |     20 |</span><br><span class="line">|  950.000000 |   800.00 | CLERK     |     20 |</span><br><span class="line">| 2975.000000 |  2975.00 | MANAGER   |     20 |</span><br><span class="line">|  950.000000 |   950.00 | CLERK     |     30 |</span><br><span class="line">| 2850.000000 |  2850.00 | MANAGER   |     30 |</span><br><span class="line">| 1400.000000 |  1250.00 | SALESMAN  |     30 |</span><br><span class="line">+-------------+----------+-----------+--------+</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示平均工资低于2000的部门和它的平均工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- aving与group by配合使用，对group by结构进行筛选</span><br><span class="line">select avg(sal) as avg_sal from emp group by deptno having avg_sal&lt;2000;</span><br><span class="line">+-------------+</span><br><span class="line">| avg_sal     |</span><br><span class="line">+-------------+</span><br><span class="line">| 1566.666667 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.16 sec)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="面试题："><a href="#面试题：" class="headerlink" title="面试题："></a>面试题：</h4><ul>
<li><p>SQL查询中各个关键字的执行先后顺序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from &gt; on &gt;join &gt; where &gt; group by &gt; with &gt; having &gt; select &gt; distinct &gt; order by &gt; limit</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/26/MySQL数据类型/" rel="next" title="MySQL数据类型">
                <i class="fa fa-chevron-left"></i> MySQL数据类型
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/img/background.jpg"
                alt="Dyson" />
            
              <p class="site-author-name" itemprop="name">Dyson</p>
              <p class="site-description motion-element" itemprop="description">起风而沐！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Dyson-x" target="_blank" title="GitHub">
                      GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://blog.csdn.net/ds19980228" target="_blank" title="CSDN">
                      CSDN</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库笔记"><span class="nav-number">1.</span> <span class="nav-text">数据库笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-插入是否更新"><span class="nav-number">1.0.1.</span> <span class="nav-text">1. 插入是否更新</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Retrieve"><span class="nav-number">1.1.</span> <span class="nav-text">Retrieve</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-where条件"><span class="nav-number">1.1.1.</span> <span class="nav-text">2.where条件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-筛选分页结果"><span class="nav-number">1.1.2.</span> <span class="nav-text">4.筛选分页结果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-Delete"><span class="nav-number">1.1.3.</span> <span class="nav-text">6.Delete</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-插入查询结果（将一张表查询结果插入到另外一张表中）"><span class="nav-number">1.1.4.</span> <span class="nav-text">7. 插入查询结果（将一张表查询结果插入到另外一张表中）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-聚合函数"><span class="nav-number">1.1.5.</span> <span class="nav-text">8. 聚合函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9-group-by子句的使用"><span class="nav-number">1.1.6.</span> <span class="nav-text">9.group by子句的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#面试题："><span class="nav-number">1.1.7.</span> <span class="nav-text">面试题：</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dyson</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>